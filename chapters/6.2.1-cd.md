持續交付
---

持續交付依賴於一系列的工具和實踐，下圖是一個持續交付的工作流：

![CD Workflow](assets/article/chapter6/continuous-delivery.jpg)

還有一系列與開發無關的技能：

1. 自動化
2. DevOps
3. 雲基礎設施
4. 以軟體為中心的哲學

###基礎設施

在我們使我們的項目可以持續交付軟體包的時候，我們需要

####本地開發環境

在本地編寫程式碼時，我們需要設定本地的開發環境。假設我們要開始一個 Java Web 項目，在我們的開發機器上，我們需要安裝：

 - 版本管理工具，如 git，用於管理原始碼。
 - IDE，如Intellij IDEA，用於搭建開發環境。
 - 構建工具，如 gradle，用於安裝依賴、執行測試、構建工程等等。
 - 語法檢測工具，如 checkstyle，用於檢查程式碼語法。
 - 單元測試框架，如 JUnit，用於進行單元測試。
 - 整合測試框架，如 Cucumber、Selenium，用於做行為測試。

除此，在我們的項目程式碼裡，我們還需要：

 - ``CI執行指令碼``，用於在 CI 上執行指定的測試。
 - ``上傳包指令碼``，用於上傳 build 完的軟體包。
 - ``部署指令碼``，用於在本地部署包到測試環境。
 - ``監控程式碼``，用於監測網站效能和使用者行為。

當然我們還需要輔助一些測試工具來測試網站，如效能測試、網路測試等等。

####持續整合環境

為什麼在這裡會出現一個持續整合環境？我也不知道，只是想到了這裡。由於我們需要持續整合，所以我們也需要一個執行持續整合伺服器的機器。

持續整合伺服器是由兩部分組成的：Master 和 Agent。即一個用於控制其他執行持續整合服務的機器，以及執行指令的機器。因此，我們需要在一臺機器上安裝 Master 軟體，在另外一臺機器上作為 Agent。在我們的 Agent上，我們需要安裝相對應的執行服務的軟體，如

 - 指定版本的語言環境 ，如Java、Python。
 - 構建工具。
 - 版本管理工具，及對應的金鑰。
 - 打包工具，如 RPM。
 - 虛擬桌面，即可以模擬桌面瀏覽器的軟體。

同時，我們還需要有一個地方放置我們的RPM包。

####測試環境

相比於上面兩個環境來說，測試環境就比較簡單了。我們只需要建立幾個不同的環境，即開發者的測試環境、QA 環境、模擬線上環境，在這幾個不同的環境上有不同的配置。

###持續部署

在持續交付之外的，還有持續部署——這個就更依賴於團隊的組織結構了。其與持續交付的對比如下圖所示：

![持續部署](assets/article/chapter6/continuous-delivery-continuous-deployment.jpg)

我們可以從圖中看到，兩者的最大不同之處在於：持續部署會直接將構建生成的部署到產品環境。這就意味著，我們不僅要有強大的技術實力，也要有足夠的組織支援才能做到。而這部分已經超出了軟體開發的內容了~~。
