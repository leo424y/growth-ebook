Web 快取
---

Web 快取是顯著提高 Web 站點的效能最有效的方法之一。主要有:

- 資料庫端快取
- 應用層快取
- 前端快取
- 客戶端快取

不同的快取類型適用於不同的環境下使用。

###資料庫端快取

這個可以用以“空間換時間”來說。比如建一個表來儲存另外一個表某個類型的資料的總條數，在每次更新資料的時候同時更新資料表和統計條數的表。在需要獲取某個類型的資料的條數的時候，就不需要 select count 去查詢，直接查詢統計表就可以了，這樣可以提高查詢的速度和資料庫的效能。

###應用層快取

應用層快取這塊跟開發人員關係最大，也是平時經常接觸的。

- 快取資料庫的查詢結果，減少資料的壓力。這個是大型網站必須做的。
- 快取磁碟檔案的資料。比如常用的資料可以放到記憶體，不用每次都去讀取磁碟，特別是密集計算的程式，比如中文分詞的詞庫。
- 快取某個耗時的計算操作，比如資料統計。

應用層快取的架構也可以分幾種：

- 嵌入式，也就是快取和應用在同一個機器。比如單機的檔案快取，java 中用 hashMap 來快取資料等等。這種快取速度快，沒有網路消耗。
- 分散式快取，把快取的資料獨立到不同的機器，通過網路來請求資料，比如常用的 memcache 就是這一類。

分散式快取一般可以分為幾種：

- 按應用切分資料到不同的快取伺服器，這是一種比較簡單和實用的方式。
- 按照某種規則（hash，路由等等）把資料儲存到不同的快取伺服器
- 代理模式，應用在獲取資料的時候都由代理透明的處理，快取機制有代理伺服器來處理

###前端快取

我們這裡說的前端快取可以理解為一般使用的 cdn 技術，利用 squid 等做前端緩衝技術，主要還是針對靜態檔案類型，比如圖片、css、js、html 等靜態檔案。

###客戶端快取

瀏覽器端的快取，可以讓使用者請求一次之後，下一次不在從伺服器端請求資料，直接從本地快取讀取，可以減輕伺服器負擔也可以加快使用者的訪問速度。

###HTML5 離線快取

application cahce 是將大部分圖片資源、js、css 等靜態資源放在 manifest 檔案配置中。當頁面開啟時通過 manifest 檔案來讀取本地檔案或是請求伺服器檔案。

離線訪問對基於網路的應用而言越來越重要。雖然所有瀏覽器都有快取機制，但它們並不可靠，也不一定總能起到預期的作用。HTML5 使用 ApplicationCache 介面可以解決由離線帶來的部分難題。前提是你需要訪問的 Web 頁面至少被線上訪問過一次。
